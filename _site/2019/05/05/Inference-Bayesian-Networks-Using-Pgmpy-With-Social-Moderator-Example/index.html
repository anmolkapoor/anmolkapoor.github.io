<!DOCTYPE html>
<html lang="en-us">

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Create and Inference Bayesian Networks using Pgmpy with Example &middot; Anmol Kapoor
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href='/public/css/poole.css'>
  <link rel="stylesheet" href='/public/css/syntax.css'>
  <link rel="stylesheet" href='/public/css/hyde.css'>
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href='/public/apple-touch-icon-144-precomposed.png'>
                                 <link rel="shortcut icon" href='/public/favicon.ico'>

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136694841-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-136694841-1');
</script>

  <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Create and Inference Bayesian Networks using Pgmpy with Example | Anmol Kapoor</title>
<meta name="generator" content="Jekyll v3.7.4" />
<meta property="og:title" content="Create and Inference Bayesian Networks using Pgmpy with Example" />
<meta name="author" content="Anmol Kapoor" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this quick notebook, we will be discussing Bayesian Statisitcs over Bayesian Networks and Inferencing them using Pgmpy Python library. Bayesian statistics is a theory in the field of statistics based on the Bayesian interpretation of probability where probability expresses a degree of belief in an event, which can change as new information is gathered, rather than a fixed value based upon frequency or propensity.Bayesian statistical methods use Bayes’ theorem to compute and update probabilities after obtaining new data. Bayes’ theorem describes the conditional probability of an event based on data as well as prior information or beliefs about the event or conditions related to the event." />
<meta property="og:description" content="In this quick notebook, we will be discussing Bayesian Statisitcs over Bayesian Networks and Inferencing them using Pgmpy Python library. Bayesian statistics is a theory in the field of statistics based on the Bayesian interpretation of probability where probability expresses a degree of belief in an event, which can change as new information is gathered, rather than a fixed value based upon frequency or propensity.Bayesian statistical methods use Bayes’ theorem to compute and update probabilities after obtaining new data. Bayes’ theorem describes the conditional probability of an event based on data as well as prior information or beliefs about the event or conditions related to the event." />
<link rel="canonical" href="http://anmolkapoor.in/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example/" />
<meta property="og:url" content="http://anmolkapoor.in/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example/" />
<meta property="og:site_name" content="Anmol Kapoor" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-05T00:00:00+05:30" />
<script type="application/ld+json">
{"description":"In this quick notebook, we will be discussing Bayesian Statisitcs over Bayesian Networks and Inferencing them using Pgmpy Python library. Bayesian statistics is a theory in the field of statistics based on the Bayesian interpretation of probability where probability expresses a degree of belief in an event, which can change as new information is gathered, rather than a fixed value based upon frequency or propensity.Bayesian statistical methods use Bayes’ theorem to compute and update probabilities after obtaining new data. Bayes’ theorem describes the conditional probability of an event based on data as well as prior information or beliefs about the event or conditions related to the event.","author":{"@type":"Person","name":"Anmol Kapoor"},"@type":"BlogPosting","url":"http://anmolkapoor.in/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example/","headline":"Create and Inference Bayesian Networks using Pgmpy with Example","dateModified":"2019-05-05T00:00:00+05:30","datePublished":"2019-05-05T00:00:00+05:30","mainEntityOfPage":{"@type":"WebPage","@id":"http://anmolkapoor.in/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example/"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body class="theme-base-personal">

<div class='sidebar header-image'
     style="background-image: url(
     
        /public/images/header_3.jpg
     
     );top:0;left:0;bottom:0;right:0;background-size:cover;background-position:center;background-repeat:no-repeat;-webkit-transition:opacity .4s ease-in-out;-moz-transition:opacity .4s ease-in-out;-ms-transition:opacity .4s ease-in-out;-o-transition:opacity .4s ease-in-out;transition:opacity .4s ease-in-out">

    <div class="container sidebar-sticky">


        <div class="sidebar-about">
            <h1>
                <a href='/'>
                    Anmol Kapoor
                </a>
            </h1>
            <p class="lead">~Working on tag line~</p>
        </div>

        <nav class="sidebar-nav">


            <a class="sidebar-nav-item"
               href='/'>Home</a>
            

            
            
            
            
            
            
            
            
            <a class="sidebar-nav-item" href="/about/">About</a>
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            


        </nav>

        <p>&copy; 2019. All rights reserved.</p>
    </div>
</div>


<div class="content container">
    <div class="post">
    <h1 class="post-title">Create and Inference Bayesian Networks using Pgmpy with Example</h1>
    <span class="post-meta-data-area">
            <span class="post-date">05 May 2019 | 4 minutes read</span>
            
                <span class="post-meta-data-icon">
                    <a href="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator" class="square_btn"><i class="fab fa-github"></i> Code</a>
                </span>
            
            
            
                <span class="post-meta-data-icon">
                    <a href="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/blob/master/python_notebook.ipynb" class="square_btn"><i class="fab fa-python"></i> Python Notebook</a>
                </span>
            
            


        </span>


    <p>In this quick notebook, we will be discussing Bayesian Statisitcs over Bayesian Networks and Inferencing them using Pgmpy Python library.
Bayesian statistics is a theory in the field of statistics based on the Bayesian interpretation of probability where probability expresses a degree of belief in an event, which can change as new information is gathered, rather than a fixed value based upon frequency or propensity.Bayesian statistical methods use Bayes’ theorem to compute and update probabilities after obtaining new data. Bayes’ theorem describes the conditional probability of an event based on data as well as prior information or beliefs about the event or conditions related to the event.</p>

<h1 id="bayes-theorem">Bayes’ theorem</h1>
<p>Bayes’ theorem is a fundamental theorem in Bayesian statistics, as it is used by Bayesian methods to update probabilities, which are degrees of belief, after obtaining new data. Given two events A and B, the conditional probability of A given that B is true is expressed as follows:
<img src="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/raw/master/images/bayes_theorem.png" alt="Bayes Theorem" /></p>

<p>The probability of the evidence P(B) can be calculated using the law of total probability. If <img src="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/raw/master/images/A_values.png" alt="A values" /> is a partition of the sample space, which is the set of all outcomes of an experiment, then:
<img src="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/raw/master/images/total_probability.png" alt="total probs" /></p>

<h1 id="bayesian-network">Bayesian network</h1>
<p>A Bayesian network is a probabilistic graphical model (a type of statistical model) that represents a set of variables and their conditional dependencies via a directed acyclic graph (DAG). Bayesian networks are ideal for taking an event that occurred and predicting the likelihood that any one of several possible known causes was the contributing factor.</p>

<h1 id="example">Example</h1>
<h3 id="statistical-moderator-for-social-platform-with-a-given-information-such-as-user-history-ml-model-prediction-other-user-flagging-the-content-etc">Statistical moderator for social platform with a given information such as user history, ML model prediction, other user flagging the content, etc</h3>
<p>We can use bayes rule and total probability theorem to infer probabilites in a bayes network. Lets take an example:</p>

<p>Example
Lets consider an example, where a social media website wish to moderate content on the site and suspends bad user accounts. For this they would like us to create a statistical moderator that can take the preemtive measure based on information given. Lets assume we have following information:</p>
<ul>
  <li>M : A prediction from a ML model that can read the content and give a score (probability) that this content should be flagged.</li>
  <li>U :  Another User flags the content.</li>
  <li>B : The account was suspended before for any bad content.</li>
  <li>R : Score (Probability) that the content should be removed from the platform.</li>
  <li>S : Score (Probability) that account should be suspended</li>
</ul>

<p>Lets assume probabilities are given to us for the network as follows:
<img src="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/raw/master/images/bayes_net_final.jpg" alt="Network" />
<img src="https://github.com/anmolkapoor/inference-bayesian-networks-using-pgmpy-example-social-media-moderator/raw/master/images/probs.png" alt="Probs" /></p>

<p><strong>Lets create this bayes network in python using pgmpy library https://github.com/pgmpy/pgmpy .</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pgmpy</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Requirement already satisfied: pgmpy in /anaconda3/lib/python3.7/site-packages (0.1.7)
Requirement already satisfied: scipy&gt;=1.0.0 in /anaconda3/lib/python3.7/site-packages (from pgmpy) (1.2.1)
Requirement already satisfied: networkx&lt;1.12,&gt;=1.11 in /anaconda3/lib/python3.7/site-packages (from pgmpy) (1.11)
Requirement already satisfied: numpy&gt;=1.14.0 in /anaconda3/lib/python3.7/site-packages (from pgmpy) (1.16.2)
Requirement already satisfied: decorator&gt;=3.4.0 in /anaconda3/lib/python3.7/site-packages (from networkx&lt;1.12,&gt;=1.11-&gt;pgmpy) (4.4.0)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>
<span class="kn">from</span> <span class="nn">pgmpy.factors.discrete</span> <span class="kn">import</span> <span class="n">TabularCPD</span>
<span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bayesNet</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">()</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s">"M"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s">"U"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s">"R"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s">"B"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="s">"S"</span><span class="p">)</span>

<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">"M"</span><span class="p">,</span> <span class="s">"R"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">"U"</span><span class="p">,</span> <span class="s">"R"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">"B"</span><span class="p">,</span> <span class="s">"R"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">"B"</span><span class="p">,</span> <span class="s">"S"</span><span class="p">)</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="s">"R"</span><span class="p">,</span> <span class="s">"S"</span><span class="p">)</span>
</code></pre></div></div>

<p>Adding CPDs for each node. A quick note is that while adding proabilities, we have to give FALSE values first.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cpd_A</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s">'M'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="o">.</span><span class="mi">95</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mo">05</span><span class="p">]])</span>
<span class="n">cpd_U</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s">'U'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="o">.</span><span class="mi">85</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">15</span><span class="p">]])</span>
<span class="n">cpd_H</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s">'B'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="o">.</span><span class="mi">90</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mi">10</span><span class="p">]])</span>

<span class="n">cpd_S</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s">'S'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.98</span><span class="p">,</span> <span class="o">.</span><span class="mi">88</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">,</span> <span class="o">.</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mo">02</span><span class="p">,</span> <span class="o">.</span><span class="mi">12</span><span class="p">,</span> <span class="o">.</span><span class="mo">05</span><span class="p">,</span> <span class="o">.</span><span class="mi">40</span><span class="p">]],</span>
                   <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s">'R'</span><span class="p">,</span> <span class="s">'B'</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>

<span class="n">cpd_R</span> <span class="o">=</span> <span class="n">TabularCPD</span><span class="p">(</span><span class="s">'R'</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span>
                   <span class="n">values</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.96</span><span class="p">,</span> <span class="o">.</span><span class="mi">86</span><span class="p">,</span> <span class="o">.</span><span class="mi">94</span><span class="p">,</span> <span class="o">.</span><span class="mi">82</span><span class="p">,</span> <span class="o">.</span><span class="mi">24</span><span class="p">,</span> <span class="o">.</span><span class="mi">15</span><span class="p">,</span> <span class="o">.</span><span class="mi">10</span><span class="p">,</span> <span class="o">.</span><span class="mo">05</span><span class="p">],</span> <span class="p">[</span><span class="o">.</span><span class="mo">04</span><span class="p">,</span> <span class="o">.</span><span class="mi">14</span><span class="p">,</span> <span class="o">.</span><span class="mo">06</span><span class="p">,</span> <span class="o">.</span><span class="mi">18</span><span class="p">,</span> <span class="o">.</span><span class="mi">76</span><span class="p">,</span> <span class="o">.</span><span class="mi">85</span><span class="p">,</span> <span class="o">.</span><span class="mi">90</span><span class="p">,</span> <span class="o">.</span><span class="mi">95</span><span class="p">]],</span>
                   <span class="n">evidence</span><span class="o">=</span><span class="p">[</span><span class="s">'M'</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'U'</span><span class="p">],</span> <span class="n">evidence_card</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">bayesNet</span><span class="o">.</span><span class="n">add_cpds</span><span class="p">(</span><span class="n">cpd_A</span><span class="p">,</span> <span class="n">cpd_U</span><span class="p">,</span> <span class="n">cpd_H</span><span class="p">,</span> <span class="n">cpd_S</span><span class="p">,</span> <span class="n">cpd_R</span><span class="p">)</span>
</code></pre></div></div>

<p>Checking if model is correctly added.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bayesNet</span><span class="o">.</span><span class="n">check_model</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Model is correct."</span><span class="p">)</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Model is correct.
</code></pre></div></div>

<p>Creating solver that uses variable elimination internally for inference.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">solver</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">bayesNet</span><span class="p">)</span>
</code></pre></div></div>

<p>Lets take some examples. For cross verification, we will be doing inference manually also using Bayes Theorem and Total Probability theorem.</p>

<h4 id="1-lets-find-proability-of-content-should-be-removed-from-the-platform">1. Lets find proability of “Content should be removed from the platform”**</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(R) 
=P(R|MBU)*P(M)*P(B)*P(U)+P(R|MBU)*P(M)*P(B)*P(!U)+P(R|MBU)*P(M)*P(!B)*P(U)
+P(R|MBU)*P(M)*P(!B)*P(!U)+P(R|MBU)*P(!M)*P(B)*P(U)+P(R|MBU)*P(!M)*P(B)*P(!U)
+P(R|MBU)*P(!M)*P(!B)*P(U)+P(R|MBU)*P(!M)*P(!B)*P(!U) --- [Using total probability theorem as R depends on M, B, U]
=0.95*0.05*0.1*0.15+0.9*0.05*0.1*0.85+0.85*0.05*0.9*0.15
+0.76*0.05*0.9*0.85+0.18*0.95*0.1*0.15+0.06*0.95*0.1*0.85
+0.14*0.95*0.9*0.15+0.04*0.95*0.9*0.85
=0.09378
</code></pre></div></div>

<p>Using pgmpy library:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">'R'</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">'R'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R 0.09378000000000002
</code></pre></div></div>

<h4 id="2-lets-find-probability-of-content-should-be-removed-from-platform-given-our-ml-model-flags-it">2. Lets find probability of “Content should be removed from platform given our ML model flags it”</h4>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>P(R|A) 
= P(R|AHU) * P(H) * P(U) + P (R|AH!U) * P(H) *P(!U) + P(R|A!HU) 
* P(!H) * P(U)+ P(R|A!H!U) * P(!H) * P(!U)                      -------- [ Using Total Probability theorem ]
=0.95*0.1*0.15 + 0.9*0.1*0.85 +0.85*0.9*0.15 + 0.76*0.9*0.85
=0.7869
</code></pre></div></div>

<p>Now, Using pgmpy libary:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">'R'</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s">'M'</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="k">print</span><span class="p">(</span><span class="s">"R| M"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">'R'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>R| M 0.7869
</code></pre></div></div>

<h4 id="pgmpy-can-also-find-complex-proability-inference-considering-dependent-and-independent-variable-considering-something-is-given">Pgmpy can also find complex proability inference considering dependent and independent variable considering something is given.</h4>
<h4 id="for-example-we-can-find-account-should-be-suspended-given-it-was-suspened-before">For example, we can find “Account should be suspended given it was suspened before”</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">result</span> <span class="o">=</span> <span class="n">solver</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="p">[</span><span class="s">'S'</span><span class="p">],</span> <span class="n">evidence</span><span class="o">=</span><span class="p">{</span><span class="s">'B'</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="k">print</span><span class="p">(</span><span class="s">"S| B"</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="s">'S'</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>S| B 0.15345299999999998
</code></pre></div></div>

<h4 id="model-has-other-features-such-as-it-can-also-find-dependencies-between-the-variables-example">Model has other features such as it can also find dependencies between the variables. Example:</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">bayesNet</span><span class="o">.</span><span class="n">get_independencies</span><span class="p">()</span>
</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(M _|_ U, B)
(M _|_ B | U)
(M _|_ U | B)
(M _|_ S | R, B)
(M _|_ S | R, U, B)
(U _|_ M, B)
(U _|_ B | M)
(U _|_ M | B)
(U _|_ S | R, B)
(U _|_ S | M, R, B)
(B _|_ M, U)
(B _|_ U | M)
(B _|_ M | U)
(S _|_ M, U | R, B)
(S _|_ U | M, R, B)
(S _|_ M | R, U, B)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="s">"Completed."</span><span class="p">)</span>

</code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Completed.
</code></pre></div></div>


</div>

<div class="related">
    <h2>Related Posts</h2>
    <ul class="related-posts">
        
        <li>
            <h3>
                <a href="/2019/05/02/Technical-Analysis-With-Indicators-And-Building-ML-Based-Trading-Strategy-Part-2/">
                    Technical Analysis with Indicators and building a ML based trading strategy (Part 2 of 2)
                    <small>02 May 2019</small>
                </a>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="/2019/05/01/Technical-Analysis-With-Indicators-And-Building-Rule-Based-Trading-Strategy-Part-1/">
                    Technical Analysis with Indicators and building a ML based trading strategy (Part 1 of 2)
                    <small>01 May 2019</small>
                </a>
            </h3>
        </li>
        
        <li>
            <h3>
                <a href="/2019/03/19/Explore-Arxiv-Repository-Using-Gensim-LDA-Topic-Modelling/">
                    Arxiv-topics - Explore & Discover Research Papers on Arxiv repository using Topics Learned from Data
                    <small>19 Mar 2019</small>
                </a>
            </h3>
        </li>
        
    </ul>
</div>

<div id="disqus_thread"></div>
<script>

    var disqus_config = function () {
    this.page.url = "http://anmolkapoor.in/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example/";
    this.page.identifier = "/2019/05/05/Inference-Bayesian-Networks-Using-Pgmpy-With-Social-Moderator-Example";
    };

    (function () { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://http-anmolkapoor-in.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
    Disqus.</a></noscript>



</div>
<!--<div>Icons made by <a href="https://www.flaticon.com/authors/roundicons" title="Roundicons">Roundicons</a> from <a-->
<!--        href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a> is licensed by <a-->
<!--        href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a>-->
<!--</div>-->
</body>
</html>
